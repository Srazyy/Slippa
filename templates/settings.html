{% extends "base.html" %}
{% block title %}Settings ‚Äî Slippa{% endblock %}

{% block content %}
<div class="card">
    <h2>Settings</h2>
    <p class="subtitle">Configure how Slippa processes your videos</p>

    <form method="POST" action="/settings" class="settings-form">
        <!-- Whisper Model -->
        <div class="setting-group">
            <label class="setting-label" for="whisper_model">
                üé§ Whisper Model
                <span class="setting-hint">Larger = more accurate but slower</span>
            </label>
            <select name="whisper_model" id="whisper_model" class="setting-select">
                {% for model in whisper_models %}
                <option value="{{ model.value }}" {% if settings.whisper_model==model.value %}selected{% endif %}>
                    {{ model.label }} ‚Äî {{ model.desc }}
                </option>
                {% endfor %}
            </select>
        </div>

        <!-- Clip Duration -->
        <div class="setting-row">
            <div class="setting-group">
                <label class="setting-label" for="min_clip_duration">
                    ‚è±Ô∏è Min Clip Duration
                    <span class="setting-hint">Seconds</span>
                </label>
                <input type="number" name="min_clip_duration" id="min_clip_duration"
                    value="{{ settings.min_clip_duration }}" min="5" max="300" class="setting-input">
            </div>
            <div class="setting-group">
                <label class="setting-label" for="max_clip_duration">
                    ‚è±Ô∏è Max Clip Duration
                    <span class="setting-hint">Seconds</span>
                </label>
                <input type="number" name="max_clip_duration" id="max_clip_duration"
                    value="{{ settings.max_clip_duration }}" min="10" max="600" class="setting-input">
            </div>
            <div class="setting-group">
                <label class="setting-label" for="target_clip_duration">
                    üéØ Target Duration
                    <span class="setting-hint">Sweet spot</span>
                </label>
                <input type="number" name="target_clip_duration" id="target_clip_duration"
                    value="{{ settings.target_clip_duration }}" min="10" max="300" class="setting-input">
            </div>
        </div>

        <!-- Max Clips -->
        <div class="setting-group">
            <label class="setting-label" for="max_clips">
                üìä Max Clips per Video
                <span class="setting-hint">Maximum number of clips to generate</span>
            </label>
            <input type="number" name="max_clips" id="max_clips" value="{{ settings.max_clips }}" min="1" max="50"
                class="setting-input" style="max-width: 120px;">
        </div>

        <!-- Smart Edit -->
        <div class="setting-group">
            <label class="setting-label" for="smart_edit">
                ‚úÇÔ∏è Smart Edit
                <span class="setting-hint">Remove silence & dead air, merge talk segments into tighter clips</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" name="smart_edit" id="smart_edit" value="on" {% if settings.smart_edit
                    %}checked{% endif %} style="width: 18px; height: 18px; accent-color: var(--accent, #8b5cf6);">
                <span>Enable smart editing</span>
            </label>
        </div>

        <!-- Gap Threshold -->
        <div class="setting-group">
            <label class="setting-label" for="gap_threshold">
                ‚è∏Ô∏è Gap Threshold
                <span class="setting-hint">Silence longer than this (seconds) is removed when Smart Edit is on</span>
            </label>
            <div style="display: flex; align-items: center; gap: 12px;">
                <input type="range" name="gap_threshold" id="gap_threshold" value="{{ settings.gap_threshold }}"
                    min="0.3" max="2.0" step="0.1" class="setting-input" style="max-width: 200px;"
                    oninput="document.getElementById('gap_val').textContent = this.value + 's'">
                <span id="gap_val" style="min-width: 32px;">{{ settings.gap_threshold }}s</span>
            </div>
        </div>

        <!-- Output Format -->
        <div class="setting-group">
            <label class="setting-label" for="output_format">
                üìê Output Format
                <span class="setting-hint">Horizontal (16:9), Vertical (9:16 for Shorts/TikTok), or Both</span>
            </label>
            <select name="output_format" id="output_format" class="setting-select" style="max-width: 200px;">
                <option value="horizontal" {% if settings.output_format=='horizontal' %}selected{% endif %}>Horizontal
                    (16:9)</option>
                <option value="vertical" {% if settings.output_format=='vertical' %}selected{% endif %}>Vertical (9:16)
                </option>
                <option value="both" {% if settings.output_format=='both' %}selected{% endif %}>Both</option>
            </select>
        </div>

        <!-- Smart Scoring -->
        <div class="setting-group">
            <label class="setting-label" for="smart_scoring">
                üß† Smart Scoring
                <span class="setting-hint">Use NLP to analyze what's being said, not just how much. Finds truly engaging
                    moments.</span>
            </label>
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" name="smart_scoring" id="smart_scoring" value="on" {% if settings.smart_scoring
                    %}checked{% endif %} style="width: 18px; height: 18px; accent-color: var(--accent, #8b5cf6);">
                <span>Enable smart AI scoring</span>
            </label>
        </div>

        <!-- Privacy -->
        <div class="setting-group">
            <label class="setting-label" for="default_privacy">
                üîí Default Upload Privacy
                <span class="setting-hint">For YouTube uploads</span>
            </label>
            <select name="default_privacy" id="default_privacy" class="setting-select" style="max-width: 200px;">
                <option value="private" {% if settings.default_privacy=='private' %}selected{% endif %}>Private</option>
                <option value="unlisted" {% if settings.default_privacy=='unlisted' %}selected{% endif %}>Unlisted
                </option>
                <option value="public" {% if settings.default_privacy=='public' %}selected{% endif %}>Public</option>
            </select>
        </div>

        <button type="submit" class="btn-primary" style="margin-top: 24px;">
            üíæ Save Settings
        </button>
    </form>
</div>
{% endblock %}